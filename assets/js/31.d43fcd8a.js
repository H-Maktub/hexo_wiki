(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{367:function(e,r,t){"use strict";t.r(r);var o=t(4),a=Object(o.a)({},(function(){var e=this,r=e._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h3",{attrs:{id:"说明"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#说明"}},[e._v("#")]),e._v(" 说明")]),e._v(" "),r("p",[e._v("caddy反代docker，加速访问速度")]),e._v(" "),r("h3",{attrs:{id:"配置"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[e._v("#")]),e._v(" 配置")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('hub.docker.{主域名} {\n  encode gzip\n  reverse_proxy * https://registry-1.docker.io {\n    header_up Host registry-1.docker.io\n    header_up X-Real-IP {http.request.remote.host}\n    header_up X-Forwarded-For {http.request.remote.host}\n    header_up X-Forwarded-Port {http.request.port}\n    header_up X-Forwarded-Proto {http.request.scheme}\n    header_down Set-Cookie registry-1.docker.io docker.{主域名}\n    header_down Www-Authenticate "Bearer realm=\\"https://auth.docker.{主域名}/token\\",service=\\"registry.docker.io\\""\n    header_down Location "https://production.cloudflare.docker.com" "https://production.cloudflare.docker.{主域名}"\n  }\n}\n\nauth.docker.{主域名} {\n  encode gzip\n  reverse_proxy * https://auth.docker.io {\n    header_up Host auth.docker.io\n    header_up X-Real-IP {http.request.remote.host}\n    header_up X-Forwarded-For {http.request.remote.host}\n    header_up X-Forwarded-Port {http.request.port}\n    header_up X-Forwarded-Proto {http.request.scheme}\n    header_down Set-Cookie auth.docker.io docker.{主域名}\n  }\n}\n\nproduction.cloudflare.docker.{主域名} {\n  encode gzip\n  reverse_proxy * https://production.cloudflare.docker.com {\n    header_up Host production.cloudflare.docker.com\n    header_up X-Real-IP {http.request.remote.host}\n    header_up X-Forwarded-For {http.request.remote.host}\n    header_up X-Forwarded-Port {http.request.port}\n    header_up X-Forwarded-Proto {http.request.scheme}\n    header_down Set-Cookie production.cloudflare.docker.com docker.{主域名}\n  }\n}\n\nhub.gcr.{主域名} {\n  encode gzip\n  reverse_proxy * https://gcr.io {\n    header_up Host gcr.io\n    header_up X-Real-IP {http.request.remote.host}\n    header_up X-Forwarded-For {http.request.remote.host}\n    header_up X-Forwarded-Port {http.request.port}\n    header_up X-Forwarded-Proto {http.request.scheme}\n    header_down Set-Cookie k8s.gcr.io gcr.{主域名}\n    header_down Www-Authenticate "Bearer realm=\\"https://hub.gcr.{主域名}/v2/token\\",service=\\"gcr.io\\""\n  }\n}\n\nhub.k8s.{主域名} {\n  encode gzip\n  reverse_proxy * https://k8s.gcr.io {\n    header_up Host k8s.gcr.io\n    header_up X-Real-IP {http.request.remote.host}\n    header_up X-Forwarded-For {http.request.remote.host}\n    header_up X-Forwarded-Port {http.request.port}\n    header_up X-Forwarded-Proto {http.request.scheme}\n    header_down Set-Cookie k8s.gcr.io gcr.{主域名}\n    header_down Www-Authenticate "Bearer realm=\\"https://hub.k8s.{主域名}/v2/token\\",service=\\"k8s.gcr.io\\""\n    header_down Location "https://storage.googleapis.com" "https://storage.googleapis.{主域名}"\n  }\n}\n\nstorage.googleapis.{主域名} {\n  encode gzip\n  reverse_proxy * https://storage.googleapis.com {\n    header_up Host storage.googleapis.com\n    header_up X-Real-IP {http.request.remote.host}\n    header_up X-Forwarded-For {http.request.remote.host}\n    header_up X-Forwarded-Port {http.request.port}\n    header_up X-Forwarded-Proto {http.request.scheme}\n    header_down Set-Cookie storage.googleapis.com storage.googleapis.{主域名}\n  }\n}\n')])])]),r("h3",{attrs:{id:"使用"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[e._v("#")]),e._v(" 使用")]),e._v(" "),r("blockquote",[r("p",[e._v("拉取"),r("code",[e._v("library/nginx")]),e._v("镜像")])]),e._v(" "),r("ol",[r("li",[e._v("方式一")])]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("docker pull hub.docker.{主域名}/library/nginx\n")])])]),r("ol",{attrs:{start:"2"}},[r("li",[e._v("方式二")])]),e._v(" "),r("blockquote",[r("p",[e._v("编辑"),r("code",[e._v("/etc/docker/daemon.json")])])]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('{\n  "registry-mirrors" : [\n    "https://hub.docker.{主域名}"\n  ]\n}\n')])])]),r("h3",{attrs:{id:"参考"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[e._v("#")]),e._v(" 参考")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://back.pub/post/docker-mirror-by-caddy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("使用Caddy加速所有Docker仓库"),r("OutboundLink")],1)])])])}),[],!1,null,null,null);r.default=a.exports}}]);