(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{418:function(a,t,s){"use strict";s.r(t);var e=s(4),r=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h3",{attrs:{id:"说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#说明"}},[a._v("#")]),a._v(" 说明")]),a._v(" "),t("blockquote",[t("p",[a._v("基于libarchive.a + podspec")])]),a._v(" "),t("h3",{attrs:{id:"编译-a静态文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#编译-a静态文件"}},[a._v("#")]),a._v(" 编译.a静态文件")]),a._v(" "),t("ol",[t("li",[a._v("下载代码 "),t("a",{attrs:{href:"https://github.com/libarchive/libarchive/releases",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/libarchive/libarchive/releases"),t("OutboundLink")],1)]),a._v(" "),t("li",[a._v("修改"),t("code",[a._v("cat/CMakeLists.txt")]),a._v(","),t("code",[a._v("tar/CMakeLists.txt")]),a._v(","),t("code",[a._v("cpio/CMakeLists.txt")]),a._v(","),t("code",[a._v("unzip/CMakeLists.txt")]),a._v(",注释掉以下内容")])]),a._v(" "),t("div",{staticClass:"language-txt extra-class"},[t("pre",{pre:!0,attrs:{class:"language-txt"}},[t("code",[a._v("# INSTALL(TARGETS bsdtar RUNTIME DESTINATION bin)\n# INSTALL_MAN(${bsdtar_MANS})\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[a._v("生成Xcode代码项目文件")])]),a._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进入项目文件夹")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 结果输出到_builds文件夹")]),a._v("\ncmake -S. "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-B_builds")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-GXcode")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DCMAKE_SYSTEM_NAME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("iOS \n")])])]),t("ol",{attrs:{start:"4"}},[t("li",[a._v("打开"),t("code",[a._v("_builds")]),a._v("文件下的"),t("code",[a._v("libarchive.xcodeproj")]),a._v("项目")]),a._v(" "),t("li",[a._v("target选择"),t("code",[a._v("archive_static")]),a._v(",并修改为"),t("code",[a._v("release")]),a._v("模式")]),a._v(" "),t("li",[a._v("开始编译，在"),t("code",[a._v("Products")]),a._v("文件夹获取"),t("code",[a._v("libarchive.a")]),a._v("文件")]),a._v(" "),t("li",[a._v("从libarchive文件夹获取两个头文件"),t("code",[a._v("archive.h")]),a._v("和"),t("code",[a._v("archive_entry.h")])])]),a._v(" "),t("h3",{attrs:{id:"创建podspec"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建podspec"}},[a._v("#")]),a._v(" 创建podspec")]),a._v(" "),t("ol",[t("li",[a._v("创建"),t("code",[a._v("pod lib create libarchive")]),a._v("，输出如下")])]),a._v(" "),t("div",{staticClass:"language-log extra-class"},[t("pre",{pre:!0,attrs:{class:"language-log"}},[t("code",[a._v("What platform do you want to use"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" iOS "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v(" macOS "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("  iOS\n\nWhat language do you want to use"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" Swift "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v(" ObjC "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" Swift\n\nWould you like to include a demo application with your library"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" Yes "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v(" No "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" Yes\n\nWhich testing frameworks will you use"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" Quick "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v(" None "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" None\n\nWould you like to do view based testing"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" Yes "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v(" No "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" No\n\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[a._v("复制文件到"),t("code",[a._v("libarchive/Classes")]),a._v("文件夹")])]),a._v(" "),t("div",{staticClass:"language-tree extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("# tree libarchive\nlibarchive\n├── Assets\n└── Classes\n    ├── include\n    │   ├── archive.h\n    │   └── archive_entry.h\n    └── lib\n        └── libarchive.a\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[a._v("修改"),t("code",[a._v("libarchive.podspec")]),a._v("文件")])]),a._v(" "),t("p",[a._v("添加以下内容")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("s.static_framework = true\ns.vendored_libraries = 'libarchive/Classes/lib/*a'\ns.libraries = 'bz2','iconv','z'\n")])])]),t("p",[a._v("修改后内容如下")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("Pod::Spec.new do |s|\n  s.name             = 'libarchive'\n  s.version          = '3.7.7'\n  s.summary          = 'A short description of libarchive.'\n  s.description      = <<-DESC\nTODO: Add long description of the pod here.\n                       DESC\n\n  s.homepage         = 'https://github.com/Maktub/libarchive'ß\n  s.license          = { :type => 'MIT', :file => 'LICENSE' }\n  s.author           = { 'Maktub' => 'maktub@example.com' }\n  s.source           = { :git => 'https://github.com/xxxxx/libarchive.git', :tag => s.version.to_s }\n  # s.social_media_url = 'https://twitter.com/<TWITTER_USERNAME>'\n\n  s.ios.deployment_target = '15.0'\n\n  s.source_files = 'libarchive/Classes/**/*'\n\n  s.static_framework = true\n  s.vendored_libraries = 'libarchive/Classes/lib/*a'\n  s.libraries = 'bz2','iconv','z'\nend\n")])])]),t("h3",{attrs:{id:"编译后libarchive-framework-目录如下"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#编译后libarchive-framework-目录如下"}},[a._v("#")]),a._v(" 编译后"),t("code",[a._v("libarchive.framework")]),a._v("，目录如下")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("libarchive.framework\n├── Headers\n│   ├── archive.h\n│   ├── archive_entry.h\n│   └── libarchive-umbrella.h\n├── Info.plist\n├── Modules\n│   └── module.modulemap # swift项目使用的关键文件\n└── libarchive\n")])])]),t("h3",{attrs:{id:"参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[a._v("#")]),a._v(" 参考")]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://blog.z6z8.cn/2024/08/05/%E4%B8%BAios%E6%9E%84%E5%BB%BAlibarchive/",target:"_blank",rel:"noopener noreferrer"}},[a._v("为ios构建libarchive"),t("OutboundLink")],1)]),a._v(" "),t("li",[t("a",{attrs:{href:"https://cmake.org/cmake/help/latest/manual/cmake-toolchains.7.html#cross-compiling-for-ios-tvos-visionos-or-watchos",target:"_blank",rel:"noopener noreferrer"}},[a._v("cross-compiling-for-ios-tvos-visionos-or-watchos"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=r.exports}}]);