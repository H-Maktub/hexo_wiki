(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{392:function(t,e,a){"use strict";a.r(e);var r=a(4),s=Object(r.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h3",{attrs:{id:"说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#说明"}},[t._v("#")]),t._v(" 说明")]),t._v(" "),e("ol",[e("li",[t._v("环境")])]),t._v(" "),e("blockquote",[e("p",[t._v("planet和ztncui是在同一台vps上")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("Planet")]),t._v("服务是直接系统上搭建")]),t._v(" "),e("li",[e("code",[t._v("ztncui")]),t._v("/"),e("code",[t._v("zerotier")]),t._v("是docker搭建")])]),t._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[t._v("表现")])]),t._v(" "),e("blockquote",[e("p",[t._v("进入"),e("code",[t._v("ztncui")]),t._v("容器，查看zerotier信息，表现为"),e("code",[t._v("ztncui")]),t._v("同vps的"),e("code",[t._v("planet")]),t._v("服务器是离线的")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("docker exec -it ztncui bash\nzerotier-cli peers\n")])])]),e("h3",{attrs:{id:"重现问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#重现问题"}},[t._v("#")]),t._v(" 重现问题")]),t._v(" "),e("ol",[e("li",[t._v("安装工具")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("apt update\napt install netcat\n")])])]),e("ol",{attrs:{start:"2"}},[e("li",[e("code",[t._v("Planet")]),t._v("服务器开启监听")])]),t._v(" "),e("blockquote",[e("p",[e("code",[t._v("-u")]),t._v("表示UDP")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("nc -ul 56789\n")])])]),e("ol",{attrs:{start:"3"}},[e("li",[e("code",[t._v("ztncui")]),t._v("容器发送消息")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("docker exec -it ztncui bash\nnc -u <服务器IP> 56789 \n")])])]),e("p",[t._v("然后输入任意字符，回车，你会发现永远永远只能发送一条信息,然后"),e("code",[t._v("ztncui")]),t._v("容器的nc就断开了，具体问题参考最后的链接")]),t._v(" "),e("h3",{attrs:{id:"修复"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修复"}},[t._v("#")]),t._v(" 修复")]),t._v(" "),e("blockquote",[e("p",[t._v("根本问题是有多个ip的时候，udp是返回的ip有问题，只需要修改"),e("code",[t._v("Planet")]),t._v("服务监听的ip就可以了,修改服务器"),e("code",[t._v("/var/lib/zerotier-one/local.conf")]),t._v(",后重启服务")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('{\n    "settings": { \n        "bind": [ "<服务器ipv4>","<服务器ipv6>" ]\n    }\n}\n\n')])])]),e("h3",{attrs:{id:"参考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://developer.aliyun.com/article/179310",target:"_blank",rel:"noopener noreferrer"}},[t._v("Docker容器网络下UDP协议的一个问题"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.zerotier.com/config/",target:"_blank",rel:"noopener noreferrer"}},[t._v("zerotier local.conf说明"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=s.exports}}]);